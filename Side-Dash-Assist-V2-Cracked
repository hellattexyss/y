local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local Workspace = game:GetService("Workspace")
local StarterGui = game:GetService("StarterGui")

local player = Players.LocalPlayer
local char = player.Character or player.CharacterAdded:Wait()
local root = char:WaitForChild("HumanoidRootPart")
local hum = char:WaitForChild("Humanoid")

player.CharacterAdded:Connect(function(newChar)
	char = newChar
	root = newChar:WaitForChild("HumanoidRootPart")
	hum = newChar:WaitForChild("Humanoid")
end)

-- Settings
local RANGE = 30
local studs = 8
local F_OFFSET = 3
local B_OFFSET = 3
local BASE_CD = 0.3
local speedMult = 0.8
local HARDCODED_DASH_COOLDOWN = 2.5

local function getCD()
	if speedMult <= 0.05 then
		speedMult = 0.05
	end
	return BASE_CD / speedMult
end

local MIN_DIST = 1.2
local MAX_DIST = 14
local ANIM_L = 10480796021
local ANIM_R = 10480793962
local SOUND_ID = 10480793962

local dashing = false
local lastDashTime = 0
local animTrack = nil
local espOn = false
local m1On = false
local dashKeyOn = false
local targetNearOn = false
local selectedPlr = nil
local EnabledFlag = true
local dashButtonLocked = false

pcall(function()
	StarterGui:SetCore("SendNotification", {
		Title = "Side Dash Assist V1";
		Text = "Enjoy! Report bugs on discord server";
		Duration = 5;
	})
end)

pcall(function()
	if setclipboard then
		setclipboard("https://discord.gg/GEVGRzC4ZP")
	end
end)

local gui = Instance.new("ScreenGui")
gui.Name = "SideDashAssistGUI"
gui.ResetOnSpawn = false
gui.Parent = player:WaitForChild("PlayerGui")

local blur = Instance.new("BlurEffect")
blur.Size = 0
blur.Parent = game:GetService("Lighting")

local function makeDraggable(guiObject)
	local dragging = false
	local dragStart, startPos, currentInput
	guiObject.InputBegan:Connect(function(inp)
		if (inp.UserInputType == Enum.UserInputType.Touch or inp.UserInputType == Enum.UserInputType.MouseButton1) and not dragging then
			dragging = true
			dragStart = inp.Position
			startPos = guiObject.Position
			currentInput = inp
			inp.Changed:Connect(function()
				if inp.UserInputState == Enum.UserInputState.End then
					dragging = false
					currentInput = nil
				end
			end)
		end
	end)
	UserInputService.InputChanged:Connect(function(inp)
		if dragging and currentInput == inp and (inp.UserInputType == Enum.UserInputType.Touch or inp.UserInputType == Enum.UserInputType.MouseMovement) then
			local delta = inp.Position - dragStart
			guiObject.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
		end
	end)
end

-- Main frame
local mainFrame = Instance.new("Frame")
mainFrame.Name = "MainFrame"
mainFrame.Size = UDim2.new(0, 380, 0, 140)
mainFrame.Position = UDim2.new(0.5, -190, 0.12, 0)
mainFrame.BackgroundColor3 = Color3.fromRGB(15, 15, 15)
mainFrame.BackgroundTransparency = 1
mainFrame.BorderSizePixel = 0
mainFrame.Visible = false
mainFrame.Parent = gui
makeDraggable(mainFrame)

local mainCorner = Instance.new("UICorner", mainFrame)
mainCorner.CornerRadius = UDim.new(0, 20)

local mainBgGradient = Instance.new("UIGradient")
mainBgGradient.Color = ColorSequence.new({
	ColorSequenceKeypoint.new(0, Color3.fromRGB(25, 5, 5)),
	ColorSequenceKeypoint.new(0.5, Color3.fromRGB(15, 15, 15)),
	ColorSequenceKeypoint.new(1, Color3.fromRGB(0, 0, 0))
})
mainBgGradient.Rotation = 90
mainBgGradient.Parent = mainFrame

local borderFrame = Instance.new("Frame")
borderFrame.Name = "BorderFrame"
borderFrame.Size = UDim2.new(1, 8, 1, 8)
borderFrame.Position = UDim2.new(0, -4, 0, -4)
borderFrame.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
borderFrame.BackgroundTransparency = 1
borderFrame.BorderSizePixel = 0
borderFrame.ZIndex = 0
borderFrame.Parent = mainFrame

local borderCorner = Instance.new("UICorner", borderFrame)
borderCorner.CornerRadius = UDim.new(0, 24)

local borderGradient = Instance.new("UIGradient")
borderGradient.Color = ColorSequence.new({
	ColorSequenceKeypoint.new(0, Color3.fromRGB(255, 0, 0)),
	ColorSequenceKeypoint.new(0.5, Color3.fromRGB(120, 0, 0)),
	ColorSequenceKeypoint.new(1, Color3.fromRGB(26, 26, 26))
})
borderGradient.Rotation = 45
borderGradient.Parent = borderFrame

local headerFrame = Instance.new("Frame")
headerFrame.Size = UDim2.new(1, 0, 0, 50)
headerFrame.BackgroundTransparency = 1
headerFrame.Parent = mainFrame

local titleLabel = Instance.new("TextLabel")
titleLabel.Size = UDim2.new(0, 190, 0, 30)
titleLabel.Position = UDim2.new(0, 20, 0, 10)
titleLabel.BackgroundTransparency = 1
titleLabel.Text = "Side Dash Assist"
titleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
titleLabel.TextSize = 23
titleLabel.Font = Enum.Font.GothamBold
titleLabel.TextXAlignment = Enum.TextXAlignment.Left
titleLabel.TextStrokeTransparency = 0.7
titleLabel.Parent = headerFrame

local versionLabel = Instance.new("TextLabel")
versionLabel.Size = UDim2.new(0, 55, 0, 24)
versionLabel.Position = UDim2.new(0, 215, 0, 13)
versionLabel.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
versionLabel.BorderSizePixel = 0
versionLabel.Text = "v1.0"
versionLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
versionLabel.TextSize = 13
versionLabel.Font = Enum.Font.GothamBold
versionLabel.Parent = headerFrame

local versionCorner = Instance.new("UICorner", versionLabel)
versionCorner.CornerRadius = UDim.new(0, 8)

local authorLabel = Instance.new("TextLabel")
authorLabel.Size = UDim2.new(1, -40, 0, 17)
authorLabel.Position = UDim2.new(0, 20, 0, 32)
authorLabel.BackgroundTransparency = 1
authorLabel.Text = "by CPS Network"
authorLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
authorLabel.TextSize = 13
authorLabel.Font = Enum.Font.GothamMedium
authorLabel.TextXAlignment = Enum.TextXAlignment.Left
authorLabel.TextTransparency = 0.28
authorLabel.Parent = headerFrame

local closeBtn = Instance.new("TextButton")
closeBtn.Size = UDim2.new(0, 35, 0, 35)
closeBtn.Position = UDim2.new(1, -45, 0, 7)
closeBtn.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
closeBtn.Text = "X"
closeBtn.Font = Enum.Font.GothamBold
closeBtn.TextColor3 = Color3.fromRGB(0, 0, 0)
closeBtn.TextSize = 19
closeBtn.BorderSizePixel = 0
closeBtn.Parent = mainFrame

local closeBtnCorner = Instance.new("UICorner", closeBtn)
closeBtnCorner.CornerRadius = UDim.new(0, 10)

local minimizeBtn = Instance.new("TextButton")
minimizeBtn.Size = UDim2.new(0, 35, 0, 35)
minimizeBtn.Position = UDim2.new(1, -85, 0, 7)
minimizeBtn.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
minimizeBtn.Text = "_"
minimizeBtn.Font = Enum.Font.GothamBold
minimizeBtn.TextColor3 = Color3.fromRGB(0, 0, 0)
minimizeBtn.TextSize = 22
minimizeBtn.BorderSizePixel = 0
minimizeBtn.Parent = mainFrame

local minimizeCorner = Instance.new("UICorner", minimizeBtn)
minimizeCorner.CornerRadius = UDim.new(0, 10)

local buttonContainer = Instance.new("Frame")
buttonContainer.Size = UDim2.new(0, 200, 0, 48)
buttonContainer.Position = UDim2.new(0.5, -100, 0, 72)
buttonContainer.BackgroundTransparency = 1
buttonContainer.Parent = mainFrame

local toggleButton = Instance.new("TextButton")
toggleButton.Size = UDim2.new(1, 0, 1, 0)
toggleButton.BackgroundTransparency = 1
toggleButton.BorderSizePixel = 0
toggleButton.TextColor3 = Color3.fromRGB(255, 255, 255)
toggleButton.TextSize = 20
toggleButton.Font = Enum.Font.GothamBold
toggleButton.AutoButtonColor = false
toggleButton.ZIndex = 2
toggleButton.Parent = buttonContainer

local buttonBg = Instance.new("Frame")
buttonBg.Size = UDim2.new(1, 0, 1, 0)
buttonBg.BackgroundColor3 = Color3.fromRGB(180, 13, 19)
buttonBg.BorderSizePixel = 0
buttonBg.ZIndex = 1
buttonBg.Parent = buttonContainer

local buttonCorner = Instance.new("UICorner", buttonBg)
buttonCorner.CornerRadius = UDim.new(0, 12)

local buttonGradient = Instance.new("UIGradient")
buttonGradient.Color = ColorSequence.new({
	ColorSequenceKeypoint.new(0, Color3.fromRGB(180, 13, 19)),
	ColorSequenceKeypoint.new(1, Color3.fromRGB(120, 0, 0))
})
buttonGradient.Rotation = 90
buttonGradient.Parent = buttonBg

local buttonBorder = Instance.new("UIStroke", buttonBg)
buttonBorder.Color = Color3.fromRGB(255, 0, 0)
buttonBorder.Thickness = 2
buttonBorder.ApplyStrokeMode = Enum.ApplyStrokeMode.Border

local function updateToggle()
	if EnabledFlag then
		toggleButton.Text = "Enabled: ON"
		TweenService:Create(buttonBg, TweenInfo.new(0.25), {BackgroundColor3 = Color3.fromRGB(180, 13, 19)}):Play()
		TweenService:Create(buttonBorder, TweenInfo.new(0.25), {Color = Color3.fromRGB(255, 0, 0)}):Play()
	else
		toggleButton.Text = "Enabled: OFF"
		TweenService:Create(buttonBg, TweenInfo.new(0.25), {BackgroundColor3 = Color3.fromRGB(54, 54, 54)}):Play()
		TweenService:Create(buttonBorder, TweenInfo.new(0.25), {Color = Color3.fromRGB(110, 110, 110)}):Play()
	end
end

toggleButton.MouseButton1Click:Connect(function()
	EnabledFlag = not EnabledFlag
	updateToggle()
end)

updateToggle()

-- Settings Overlay
local settingsBtn = Instance.new("TextButton")
settingsBtn.Size = UDim2.new(0, 36, 0, 36)
settingsBtn.Position = UDim2.new(0, 10, 1, -46)
settingsBtn.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
settingsBtn.Text = "âš™"
settingsBtn.Font = Enum.Font.GothamBold
settingsBtn.TextColor3 = Color3.fromRGB(0,0,0)
settingsBtn.TextSize = 19
settingsBtn.BorderSizePixel = 0
settingsBtn.Parent = mainFrame
local settingsBtnCorner = Instance.new("UICorner", settingsBtn)
settingsBtnCorner.CornerRadius = UDim.new(1, 0)

local settingsOverlay = Instance.new("Frame")
settingsOverlay.Name = "SettingsOverlay"
settingsOverlay.Size = UDim2.new(0, 300, 0, 190)
settingsOverlay.Position = UDim2.new(0, 40, 0.2, 0)
settingsOverlay.BackgroundColor3 = Color3.fromRGB(15, 15, 15)
settingsOverlay.BackgroundTransparency = 1
settingsOverlay.BorderSizePixel = 0
settingsOverlay.Visible = false
settingsOverlay.Parent = gui
makeDraggable(settingsOverlay)

local overlayCorner = Instance.new("UICorner", settingsOverlay)
overlayCorner.CornerRadius = UDim.new(0, 19)

local overlayGradient = Instance.new("UIGradient", settingsOverlay)
overlayGradient.Color = ColorSequence.new({
	ColorSequenceKeypoint.new(0, Color3.fromRGB(25, 5, 5)),
	ColorSequenceKeypoint.new(0.5, Color3.fromRGB(15, 15, 15)),
	ColorSequenceKeypoint.new(1, Color3.fromRGB(0, 0, 0))
})
overlayGradient.Rotation = 90

local settingsTitle = Instance.new("TextLabel")
settingsTitle.Size = UDim2.new(1, -60, 0, 40)
settingsTitle.Position = UDim2.new(0, 16, 0, 5)
settingsTitle.BackgroundTransparency = 1
settingsTitle.Text = "Settings"
settingsTitle.TextColor3 = Color3.fromRGB(255, 255, 255)
settingsTitle.TextSize = 21
settingsTitle.Font = Enum.Font.GothamBold
settingsTitle.TextXAlignment = Enum.TextXAlignment.Left
settingsTitle.Parent = settingsOverlay

local settingsCloseBtn = Instance.new("TextButton")
settingsCloseBtn.Size = UDim2.new(0, 35, 0, 35)
settingsCloseBtn.Position = UDim2.new(1, -45, 0, 6)
settingsCloseBtn.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
settingsCloseBtn.Text = "X"
settingsCloseBtn.Font = Enum.Font.GothamBold
settingsCloseBtn.TextColor3 = Color3.fromRGB(0, 0, 0)
settingsCloseBtn.TextSize = 19
settingsCloseBtn.BorderSizePixel = 0
settingsCloseBtn.Parent = settingsOverlay
local settingsCloseCorner = Instance.new("UICorner", settingsCloseBtn)
settingsCloseCorner.CornerRadius = UDim.new(0, 10)

local comingSoon = Instance.new("TextLabel")
comingSoon.Size = UDim2.new(1, 0, 0, 40)
comingSoon.Position = UDim2.new(0, 0, 0, 52)
comingSoon.BackgroundTransparency = 1
comingSoon.Text = "COMING SOON!..."
comingSoon.TextColor3 = Color3.fromRGB(255, 60, 60)
comingSoon.TextSize = 22
comingSoon.Font = Enum.Font.GothamBold
comingSoon.TextXAlignment = Enum.TextXAlignment.Center
comingSoon.Parent = settingsOverlay

local keybindFrame = Instance.new("Frame")
keybindFrame.Size = UDim2.new(1, -32, 0, 90)
keybindFrame.Position = UDim2.new(0, 16, 0, 98)
keybindFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
keybindFrame.BorderSizePixel = 0
keybindFrame.Parent = settingsOverlay

local keybindCorner = Instance.new("UICorner", keybindFrame)
keybindCorner.CornerRadius = UDim.new(0, 14)

local keyTitle = Instance.new("TextLabel")
keyTitle.Size = UDim2.new(1, -20, 0, 24)
keyTitle.Position = UDim2.new(0, 10, 0, 8)
keyTitle.BackgroundTransparency = 1
keyTitle.Text = "Keybind Info"
keyTitle.TextColor3 = Color3.fromRGB(230, 230, 230)
keyTitle.TextSize = 18
keyTitle.Font = Enum.Font.GothamBold
keyTitle.TextXAlignment = Enum.TextXAlignment.Left
keyTitle.Parent = keybindFrame

local keyInfo = Instance.new("TextLabel")
keyInfo.Size = UDim2.new(1, -20, 0, 24)
keyInfo.Position = UDim2.new(0, 10, 0, 40)
keyInfo.BackgroundTransparency = 1
keyInfo.Text = "PC Keybind: E | Gamepad: DPad Up"
keyInfo.TextColor3 = Color3.fromRGB(205, 205, 205)
keyInfo.TextSize = 16
keyInfo.Font = Enum.Font.Gotham
keyInfo.TextXAlignment = Enum.TextXAlignment.Left
keyInfo.Parent = keybindFrame

-- Open/Close GUI buttons
local openButton = Instance.new("TextButton")
openButton.Name = "OpenGuiButton"
openButton.Size = UDim2.new(0, 90, 0, 34)
openButton.Position = UDim2.new(0, 10, 0.5, -17)
openButton.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
openButton.Text = "Open GUI"
openButton.TextColor3 = Color3.fromRGB(255,255,255)
openButton.TextSize = 15
openButton.Font = Enum.Font.GothamBold
openButton.BorderSizePixel = 0
openButton.Visible = false
openButton.Parent = gui
local openCorner = Instance.new("UICorner", openButton)
openCorner.CornerRadius = UDim.new(0, 10)
makeDraggable(openButton)

local lockButton = Instance.new("TextButton")
lockButton.Name = "LockButton"
lockButton.Size = UDim2.new(0, 90, 0, 34)
lockButton.Position = UDim2.new(0, 110, 0.5, -17)
lockButton.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
lockButton.Text = "ðŸ”“ Unlocked"
lockButton.TextColor3 = Color3.fromRGB(255,255,255)
lockButton.TextSize = 13
lockButton.Font = Enum.Font.GothamBold
lockButton.BorderSizePixel = 0
lockButton.Visible = false
lockButton.Parent = gui
local lockCorner = Instance.new("UICorner", lockButton)
lockCorner.CornerRadius = UDim.new(0, 10)
makeDraggable(lockButton)

local function notify(text)
	pcall(function()
		StarterGui:SetCore("SendNotification", {
			Title = "Side Dash Assist";
			Text = text;
			Duration = 2;
		})
	end)
end

lockButton.MouseButton1Click:Connect(function()
	dashButtonLocked = not dashButtonLocked
	if dashButtonLocked then
		lockButton.Text = "ðŸ”’ Locked"
		notify("Dash button locked in place.")
	else
		lockButton.Text = "ðŸ”“ Unlocked"
		notify("Dash button can be dragged again.")
	end
end)

closeBtn.MouseButton1Click:Connect(function()
	TweenService:Create(blur, TweenInfo.new(0.3), {Size = 0}):Play()
	TweenService:Create(mainFrame, TweenInfo.new(0.3), {BackgroundTransparency = 1}):Play()
	TweenService:Create(borderFrame, TweenInfo.new(0.3), {BackgroundTransparency = 1}):Play()
	wait(0.3)
	mainFrame.Visible = false
	openButton.Visible = true
	lockButton.Visible = true
end)

minimizeBtn.MouseButton1Click:Connect(function()
	TweenService:Create(blur, TweenInfo.new(0.3), {Size = 0}):Play()
	TweenService:Create(mainFrame, TweenInfo.new(0.3), {BackgroundTransparency = 1}):Play()
	TweenService:Create(borderFrame, TweenInfo.new(0.3), {BackgroundTransparency = 1}):Play()
	wait(0.3)
	mainFrame.Visible = false
	openButton.Visible = true
	lockButton.Visible = true
end)

openButton.MouseButton1Click:Connect(function()
	openButton.Visible = false
	lockButton.Visible = false
	mainFrame.Visible = true
	TweenService:Create(blur, TweenInfo.new(0.3), {Size = 12}):Play()
	TweenService:Create(mainFrame, TweenInfo.new(0.3), {BackgroundTransparency = 0}):Play()
	TweenService:Create(borderFrame, TweenInfo.new(0.3), {BackgroundTransparency = 0}):Play()
end)

settingsBtn.MouseButton1Click:Connect(function()
	settingsOverlay.Visible = true
	TweenService:Create(settingsOverlay, TweenInfo.new(0.25), {BackgroundTransparency = 0}):Play()
end)

settingsCloseBtn.MouseButton1Click:Connect(function()
	local t = TweenService:Create(settingsOverlay, TweenInfo.new(0.25), {BackgroundTransparency = 1})
	t:Play()
	t.Completed:Connect(function()
		settingsOverlay.Visible = false
	end)
end)

mainFrame.Visible = true
TweenService:Create(blur, TweenInfo.new(0.3), {Size = 12}):Play()
TweenService:Create(mainFrame, TweenInfo.new(0.3), {BackgroundTransparency = 0}):Play()
TweenService:Create(borderFrame, TweenInfo.new(0.3), {BackgroundTransparency = 0}):Play()

--// DASH LOGIC

local function getEvent()
	local c = player.Character or player.CharacterAdded:Wait()
	if c then
		return c:FindFirstChild("Communicate")
	end
	return nil
end

local function fireEvent(data)
	pcall(function()
		local e = getEvent()
		if e and type(e.FireServer) == "function" then
			e:FireServer(unpack(data))
		end
	end)
end

local function sendDash()
	fireEvent({
		[1] = {
			Dash = Enum.KeyCode.W,
			Key = Enum.KeyCode.E,
			Goal = "KeyPress",
		},
	})
end

local function click()
	local press = {
		[1] = {
			Mobile = true,
			Goal = "LeftClick",
		},
	}
	local release = {
		[1] = {
			Goal = "LeftClickRelease",
			Mobile = true,
		},
	}
	pcall(function()
		local e = getEvent()
		if e and type(e.FireServer) == "function" then
			e:FireServer(unpack(press))
			task.wait(0.06)
			e:FireServer(unpack(release))
		end
	end)
end

local sound = Instance.new("Sound")
sound.Name = "DashSFX"
sound.SoundId = "rbxassetid://72014632956520"
sound.Volume = 2
sound.Looped = false
sound.Parent = Workspace

local function angleDiff(a, b)
	local diff = a - b
	while math.pi < diff do
		diff = diff - 2 * math.pi
	end
	while diff < -math.pi do
		diff = diff + 2 * math.pi
	end
	return diff
end

local function ease(t)
	t = math.clamp(t, 0, 1)
	return 1 - (1 - t) ^ 3
end

local function getHumAndAnim()
	if not char or not char.Parent then
		return nil, nil
	end
	local h = char:FindFirstChildOfClass("Humanoid") or char:FindFirstChild("Humanoid")
	if not h then
		return nil, nil
	end
	local a = h:FindFirstChildOfClass("Animator")
	if not a then
		a = Instance.new("Animator")
		a.Name = "Animator"
		a.Parent = h
	end
	return h, a
end

local function playAnim(isLeft, dur)
	pcall(function()
		if animTrack and animTrack.IsPlaying then
			animTrack:Stop()
		end
		animTrack = nil
	end)

	local h, a = getHumAndAnim()
	if not h or not a then
		return
	end

	local id = isLeft and ANIM_L or ANIM_R
	if not id then
		return
	end

	local anim = Instance.new("Animation")
	anim.Name = "CircularSideAnim"
	anim.AnimationId = "rbxassetid://" .. tostring(id)

	local success, track = pcall(function()
		return a:LoadAnimation(anim)
	end)

	if not success or not track then
		anim:Destroy()
		return
	end

	animTrack = track
	track.Priority = Enum.AnimationPriority.Action
	track:Play()

	pcall(function()
		if sound and sound.Parent then
			sound:Stop()
			sound:Play()
		end
	end)

	task.delay((dur or BASE_CD) + 0.15, function()
		if track and track.IsPlaying then
			pcall(function()
				track:Stop()
			end)
		end
		pcall(function()
			anim:Destroy()
		end)
	end)
end

local function findTarget(range)
	range = range or RANGE
	if not root then
		return nil, nil
	end

	local myPos = root.Position
	local nearest = nil
	local dist = math.huge

	for _, plr in pairs(Players:GetPlayers()) do
		if plr ~= player and plr.Character then
			local tRoot = plr.Character:FindFirstChild("HumanoidRootPart")
			local tHum = plr.Character:FindFirstChild("Humanoid")
			if tRoot and tHum and tHum.Health > 0 then
				local d = (tRoot.Position - myPos).Magnitude
				if d < dist and d <= range then
					nearest = plr.Character
					dist = d
				end
			end
		end
	end

	for _, obj in pairs(Workspace:GetDescendants()) do
		if obj:IsA("Model") and obj:FindFirstChild("Humanoid") and obj:FindFirstChild("HumanoidRootPart") then
			if not Players:GetPlayerFromCharacter(obj) then
				local tHum = obj:FindFirstChild("Humanoid")
				local tRoot = obj:FindFirstChild("HumanoidRootPart")
				if tHum and tHum.Health > 0 and tRoot then
					local d = (tRoot.Position - myPos).Magnitude
					if d < dist and d <= range then
						nearest = obj
						dist = d
					end
				end
			end
		end
	end

	return nearest, dist
end

local function dash(target)
	if dashing or (tick() - lastDashTime) < HARDCODED_DASH_COOLDOWN then
		return false
	end
	if not target or not target:FindFirstChild("HumanoidRootPart") then
		return false
	end
	if not root then
		return false
	end

	dashing = true
	lastDashTime = tick()

	local tRoot = target.HumanoidRootPart
	local tPos = tRoot.Position
	local myPos = root.Position
	local tLook = tRoot.CFrame.LookVector

	local dot = tLook:Dot(myPos - tPos)
	local endPos

	if dot > 0 then
		endPos = tPos - tLook * F_OFFSET
	else
		endPos = tPos + tLook * B_OFFSET
	end

	endPos = Vector3.new(endPos.X, tPos.Y + 0.5, endPos.Z)

	local horDist = (Vector3.new(myPos.X, 0, myPos.Z) - Vector3.new(tPos.X, 0, tPos.Z)).Magnitude
	local clampDist = math.clamp(studs, MIN_DIST, MAX_DIST)

	local dashOff = (Vector3.new(endPos.X, 0, endPos.Z) - Vector3.new(tPos.X, 0, tPos.Z)).Magnitude
	local angleTo = math.atan2(myPos.Z - tPos.Z, myPos.X - tPos.X)
	local angleOff = angleDiff(math.atan2(endPos.Z - tPos.Z, endPos.X - tPos.X), angleTo)
	local isLeft = angleOff > 0

	local cd = getCD()

	pcall(function()
		playAnim(isLeft, cd)
	end)

	local cam = Workspace.CurrentCamera
	local autoRot = nil

	pcall(function()
		if hum then
			autoRot = hum.AutoRotate
			hum.AutoRotate = false
		end
	end)

	local startLook = root.CFrame.LookVector
	local startAng = math.atan2(startLook.Z, startLook.X)
	local startTime = tick()
	local lastUp = startTime

	local conn
	conn = RunService.Heartbeat:Connect(function()
		if not tRoot or not tRoot.Parent then
			if hum and autoRot ~= nil then
				pcall(function()
					hum.AutoRotate = autoRot
				end)
			end
			if conn and conn.Connected then
				conn:Disconnect()
			end
			dashing = false
			return
		end

		local now = tick()
		local prog = math.clamp((now - startTime) / cd, 0, 1)
		local eased = ease(prog)

		local curAng
		if prog <= 0.5 then
			curAng = horDist + (clampDist - horDist) * ease(prog / 0.5)
		else
			curAng = clampDist + (dashOff - clampDist) * ease((prog - 0.5) / 0.5)
		end
		curAng = math.clamp(curAng, MIN_DIST, MAX_DIST)

		local curTargetAng = angleTo + angleOff * eased
		local newPos = Vector3.new(
			tPos.X + curAng * math.cos(curTargetAng),
			myPos.Y + (endPos.Y - myPos.Y) * eased,
			tPos.Z + curAng * math.sin(curTargetAng)
		)

		local lookDir = tRoot.Position - newPos
		if lookDir.Magnitude < 0.001 then
			lookDir = Vector3.new(tLook.X, 0, tLook.Z)
		end

		local lookAng = math.atan2(lookDir.Z, lookDir.X)
		local curLookAng = startAng + angleDiff(lookAng, startAng) * eased
		local curLookVec = Vector3.new(math.cos(curLookAng), 0, math.sin(curLookAng))

		local dtTime = math.max(0.0001, now - lastUp)
		lastUp = now
		local vel = (newPos - root.Position) / dtTime

		pcall(function()
			if root and root.Parent then
				root.AssemblyLinearVelocity = vel
				root.CFrame = CFrame.new(root.Position, root.Position + curLookVec)
			end
		end)

		pcall(function()
			if cam and cam.CFrame and tRoot and tRoot.Parent then
				cam.CFrame = CFrame.new(cam.CFrame.Position, tRoot.Position)
			end
		end)

		if prog >= 1 then
			if conn and conn.Connected then
				conn:Disconnect()
			end

			pcall(function()
				if root and root.Parent then
					root.AssemblyLinearVelocity = Vector3.new(0, 0, 0)
					root.CFrame = CFrame.new(newPos, newPos + Vector3.new(math.cos(lookAng), 0, math.sin(lookAng)))
				end
			end)

			pcall(function()
				if animTrack and animTrack.IsPlaying then
					animTrack:Stop()
				end
				animTrack = nil
			end)

			if hum and autoRot ~= nil then
				pcall(function()
					hum.AutoRotate = autoRot
				end)
			end

			dashing = false
		end
	end)

	return true
end

--// DASH BUTTON + SETTINGS + ESP + TOGGLES

local clickSnd = Instance.new("Sound")
clickSnd.SoundId = "rbxassetid://6042053626"
clickSnd.Volume = 0.7
clickSnd.Parent = gui

-- RED CIRCULAR DASH BUTTON WITH ICONS
local dashBtn = Instance.new("ImageButton")
dashBtn.Name = "DashButton_Final"
dashBtn.Size = UDim2.new(0, 110, 0, 110)
dashBtn.Position = UDim2.new(0, 15, 0.5, -55)
dashBtn.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
dashBtn.BorderSizePixel = 0
dashBtn.BackgroundTransparency = 0
dashBtn.AutoButtonColor = false
dashBtn.Parent = gui
dashBtn.Active = true

local round = Instance.new("UICorner", dashBtn)
round.CornerRadius = UDim.new(1, 0)

local grad = Instance.new("UIGradient")
grad.Color = ColorSequence.new({
	ColorSequenceKeypoint.new(0, Color3.fromRGB(255, 80, 80)),
	ColorSequenceKeypoint.new(0.5, Color3.fromRGB(220, 0, 0)),
	ColorSequenceKeypoint.new(1, Color3.fromRGB(150, 0, 0))
})
grad.Rotation = 45
grad.Parent = dashBtn

-- Bottom icon
local icon1 = Instance.new("ImageLabel")
icon1.BackgroundTransparency = 1
icon1.Size = UDim2.new(0, 60, 0, 60)
icon1.Position = UDim2.new(0.5, -30, 0.5, -20)
icon1.Image = "rbxassetid://110530089410634"
icon1.Parent = dashBtn

-- Top icon (your custom one)
local icon2 = Instance.new("ImageLabel")
icon2.BackgroundTransparency = 1
icon2.Size = UDim2.new(0, 38, 0, 38)
icon2.Position = UDim2.new(0.5, -19, 0, 6)
icon2.Image = "rbxassetid://12443244342"
icon2.Parent = dashBtn

local pressSnd = Instance.new("Sound")
pressSnd.Name = "PressSFX"
pressSnd.SoundId = "rbxassetid://" .. tostring(SOUND_ID)
pressSnd.Volume = 0.9
pressSnd.Looped = false
pressSnd.Parent = dashBtn

local pressed = false
local dragging = false
local dragStart = nil
local btnStart = nil
local dragIn = nil
local DRAG_THRESH = 8

local function doDashFromButton()
	if dashing or not EnabledFlag then
		return
	end
	local t = nil
	if selectedPlr and selectedPlr.Character and selectedPlr.Character:FindFirstChild("HumanoidRootPart") then
		t = selectedPlr.Character
	elseif targetNearOn then
		t = findTarget(RANGE)
	else
		t = findTarget(RANGE)
	end
	if t then
		local success = false
		pcall(function()
			success = dash(t)
		end)
		if success then
			pcall(function()
				pressSnd:Play()
			end)
			if m1On then
				task.delay(0.15, function()
					pcall(click)
				end)
			end
			if dashKeyOn then
				pcall(sendDash)
			end
		end
	end
end

local function onInputStart(input)
	if input.UserInputType == Enum.UserInputType.Touch or input.UserInputType == Enum.UserInputType.MouseButton1 then
		pressed = true
		dragging = false
		dragStart = input.Position
		btnStart = dashBtn.Position
		dragIn = input

		input.Changed:Connect(function()
			if input.UserInputState == Enum.UserInputState.End then
				pressed = false
				dragIn = nil
				dragStart = nil
				btnStart = nil
			end
		end)
	end
end

local function onInputChange(input)
	if not pressed or not dragStart or input ~= dragIn then
		return
	end

	local delta = input.Position - dragStart
	if not dragging and delta.Magnitude >= DRAG_THRESH then
		if dashButtonLocked then return end
		dragging = true
	end

	if dragging and not dashButtonLocked then
		local view = Workspace.CurrentCamera.ViewportSize
		dashBtn.Position = UDim2.new(
			0,
			math.clamp(btnStart.X.Offset + delta.X, 0, view.X - dashBtn.AbsoluteSize.X),
			0,
			math.clamp(btnStart.Y.Offset + delta.Y, 0, view.Y - dashBtn.AbsoluteSize.Y)
		)
	end
end

UserInputService.InputChanged:Connect(function(input)
	pcall(function()
		onInputChange(input)
	end)
end)

UserInputService.InputEnded:Connect(function(input)
	if input ~= dragIn or not pressed then
		return
	end

	if not dragging then
		doDashFromButton()
	end

	pressed = false
	dragging = false
	dragIn = nil
	btnStart = nil
	dragStart = nil
end)

dashBtn.InputBegan:Connect(function(input)
	pcall(function()
		onInputStart(input)
	end)
end)

dashBtn.MouseButton1Click:Connect(function()
	doDashFromButton()
end)

UserInputService.InputBegan:Connect(function(input, processed)
	if processed or dashing or not EnabledFlag then
		return
	end

	local isDash = (input.UserInputType == Enum.UserInputType.Keyboard and input.KeyCode == Enum.KeyCode.E)
		or (input.UserInputType == Enum.UserInputType.Gamepad1 and input.KeyCode == Enum.KeyCode.DPadUp)

	if isDash then
		doDashFromButton()
	end
end)

-- SETTINGS TOGGLES
local espFolder = Instance.new("Folder", gui)
espFolder.Name = "ESPFolder"

local function clearESP()
	for _, obj in ipairs(espFolder:GetChildren()) do
		obj:Destroy()
	end
end

local function makeESP(target)
	clearESP()
	if not target or not target.Parent then
		return
	end

	local rootPart = target:FindFirstChild("HumanoidRootPart") or target.PrimaryPart or target:FindFirstChildWhichIsA("BasePart")
	if not rootPart then
		return
	end

	local billboard = Instance.new("BillboardGui")
	billboard.Size = UDim2.new(0, 120, 0, 40)
	billboard.Adornee = rootPart
	billboard.AlwaysOnTop = true
	billboard.Parent = espFolder
	billboard.StudsOffset = Vector3.new(0, 4, 0)

	local bg = Instance.new("Frame")
	bg.Size = UDim2.new(1, 0, 1, 0)
	bg.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
	bg.BackgroundTransparency = 0.2
	bg.BorderSizePixel = 0
	bg.Parent = billboard

	local bgCorner = Instance.new("UICorner", bg)
	bgCorner.CornerRadius = UDim.new(0, 6)

	local text = Instance.new("TextLabel")
	text.Size = UDim2.new(1, 0, 1, 0)
	text.BackgroundTransparency = 1
	text.Text = target.Name or "Target"
	text.Font = Enum.Font.GothamBold
	text.TextSize = 16
	text.TextColor3 = Color3.fromRGB(255, 255, 255)
	text.TextStrokeTransparency = 0.5
	text.TextScaled = false
	text.Parent = billboard
end

local togglesFrame = Instance.new("Frame")
togglesFrame.Size = UDim2.new(1, -20, 0, 90)
togglesFrame.Position = UDim2.new(0, 10, 0, 50)
togglesFrame.BackgroundTransparency = 1
togglesFrame.Parent = mainFrame

local grid = Instance.new("UIGridLayout")
grid.CellSize = UDim2.new(0.5, -10, 0, 35)
grid.CellPadding = UDim2.new(0, 10, 0, 10)
grid.HorizontalAlignment = Enum.HorizontalAlignment.Center
grid.VerticalAlignment = Enum.VerticalAlignment.Top
grid.Parent = togglesFrame

local function addToggle(name, callback)
	local btn = Instance.new("TextButton")
	btn.Size = UDim2.new(0, 100, 0, 35)
	btn.BackgroundColor3 = Color3.fromRGB(245, 245, 245)
	btn.Text = name
	btn.TextColor3 = Color3.fromRGB(0, 0, 0)
	btn.Font = Enum.Font.Gotham
	btn.TextSize = 14
	btn.AutoButtonColor = false
	btn.Parent = togglesFrame

	local btnCorner = Instance.new("UICorner", btn)
	btnCorner.CornerRadius = UDim.new(0, 8)

	local ind = Instance.new("Frame")
	ind.Size = UDim2.new(0, 15, 0, 15)
	ind.Position = UDim2.new(1, -24, 0.5, -7)
	ind.BackgroundColor3 = Color3.fromRGB(180, 180, 180)
	ind.Parent = btn

	local indCorner = Instance.new("UICorner", ind)
	indCorner.CornerRadius = UDim.new(1, 0)

	local on = false

	btn.MouseButton1Click:Connect(function()
		clickSnd:Play()
		on = not on

		TweenService:Create(ind, TweenInfo.new(0.16), {
			BackgroundColor3 = on and Color3.fromRGB(0, 200, 0) or Color3.fromRGB(180, 180, 180),
		}):Play()

		if callback then
			callback(on)
		end
	end)

	return btn
end

addToggle("Target Near", function(on)
	targetNearOn = on
	if on then
		selectedPlr = nil
		if espOn and root then
			local near = findTarget(RANGE)
			if near then
				makeESP(near)
			end
		else
			clearESP()
		end
	else
		clearESP()
	end
end)

addToggle("M1", function(on)
	m1On = on
end)

addToggle("Dash", function(on)
	dashKeyOn = on
end)

addToggle("ESP", function(on)
	espOn = on
	if not on then
		clearESP()
	else
		local t = nil
		if selectedPlr and selectedPlr.Character then
			t = selectedPlr.Character
		elseif targetNearOn then
			t = findTarget(RANGE)
		end

		if t then
			makeESP(t)
		end
	end
end)

-- PLAYER LIST
local plrFrame = Instance.new("ScrollingFrame")
plrFrame.Size = UDim2.new(1, -20, 0, 70)
plrFrame.Position = UDim2.new(0, 10, 0, 145)
plrFrame.BackgroundColor3 = Color3.fromRGB(220, 220, 220)
plrFrame.ScrollBarThickness = 4
plrFrame.Parent = mainFrame

local listCorner = Instance.new("UICorner", plrFrame)
listCorner.CornerRadius = UDim.new(0, 8)

local plrLayout = Instance.new("UIListLayout")
plrLayout.Parent = plrFrame
plrLayout.Padding = UDim.new(0, 2)

local function refreshList()
	for _, obj in ipairs(plrFrame:GetChildren()) do
		if obj:IsA("TextButton") then
			obj:Destroy()
		end
	end

	for _, plr in ipairs(Players:GetPlayers()) do
		if plr ~= player then
			local btn = Instance.new("TextButton")
			btn.Size = UDim2.new(1, -5, 0, 22)
			btn.BackgroundColor3 = Color3.fromRGB(235, 235, 235)
			btn.TextColor3 = Color3.fromRGB(0, 0, 0)
			btn.TextXAlignment = Enum.TextXAlignment.Left
			btn.TextSize = 14
			btn.Font = Enum.Font.Gotham
			btn.Text = "   " .. plr.Name
			btn.Parent = plrFrame

			local btnCorner = Instance.new("UICorner", btn)
			btnCorner.CornerRadius = UDim.new(0, 6)

			btn.MouseButton1Click:Connect(function()
				clickSnd:Play()

				for _, other in ipairs(plrFrame:GetChildren()) do
					if other:IsA("TextButton") then
						other.BackgroundColor3 = Color3.fromRGB(235, 235, 235)
					end
				end

				btn.BackgroundColor3 = Color3.fromRGB(100, 200, 255)
				selectedPlr = plr
				targetNearOn = false

				if espOn and plr.Character then
					makeESP(plr.Character)
				end

				print("Selected player:", plr.Name)
			end)
		end
	end
end

refreshList()

local refreshBtn = Instance.new("TextButton")
refreshBtn.Size = UDim2.new(0, 90, 0, 28)
refreshBtn.Position = UDim2.new(1, -100, 1, -35)
refreshBtn.BackgroundColor3 = Color3.fromRGB(90, 90, 90)
refreshBtn.Text = "Refresh"
refreshBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
refreshBtn.Font = Enum.Font.GothamBold
refreshBtn.TextSize = 14
refreshBtn.Parent = mainFrame

local refreshCorner = Instance.new("UICorner", refreshBtn)
refreshCorner.CornerRadius = UDim.new(0, 8)

refreshBtn.MouseButton1Click:Connect(function()
	clickSnd:Play()
	refreshList()
end)

local adjustBtn = Instance.new("TextButton")
adjustBtn.Size = UDim2.new(0, 80, 0, 28)
adjustBtn.Position = UDim2.new(0, 10, 1, -35)
adjustBtn.BackgroundColor3 = Color3.fromRGB(110, 110, 110)
adjustBtn.Text = "Adjust"
adjustBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
adjustBtn.Font = Enum.Font.GothamBold
adjustBtn.TextSize = 14
adjustBtn.Parent = mainFrame

local adjustCorner = Instance.new("UICorner", adjustBtn)
adjustCorner.CornerRadius = UDim.new(0, 8)

local adjustMenu = nil

local function makeAdjustMenu()
	if adjustMenu and adjustMenu.Parent then
		return
	end

	adjustMenu = Instance.new("Frame")
	adjustMenu.Name = "AdjustMiniMenu"
	adjustMenu.Size = UDim2.new(0, 260, 0, 120)
	adjustMenu.Position = UDim2.new(0.5, -130, 0.5, -60)
	adjustMenu.BackgroundColor3 = Color3.fromRGB(245, 245, 245)
	adjustMenu.BorderSizePixel = 2
	adjustMenu.Parent = gui

	local adjCorner = Instance.new("UICorner", adjustMenu)
	adjCorner.CornerRadius = UDim.new(0, 12)

	local title = Instance.new("TextLabel")
	title.Size = UDim2.new(1, 0, 0, 30)
	title.Position = UDim2.new(0, 0, 0, 8)
	title.BackgroundTransparency = 1
	title.Text = "Adjust Settings"
	title.Font = Enum.Font.GothamBold
	title.TextSize = 18
	title.TextColor3 = Color3.fromRGB(25, 25, 25)
	title.Parent = adjustMenu

	local studsLabel = Instance.new("TextLabel")
	studsLabel.Size = UDim2.new(0, 70, 0, 28)
	studsLabel.Position = UDim2.new(0, 12, 0, 46)
	studsLabel.BackgroundTransparency = 1
	studsLabel.Text = "Studs"
	studsLabel.Font = Enum.Font.Gotham
	studsLabel.TextSize = 16
	studsLabel.TextColor3 = Color3.fromRGB(25, 25, 25)
	studsLabel.TextXAlignment = Enum.TextXAlignment.Left
	studsLabel.Parent = adjustMenu

	local studsVal = Instance.new("TextLabel")
	studsVal.Size = UDim2.new(0, 50, 0, 28)
	studsVal.Position = UDim2.new(0, 110, 0, 46)
	studsVal.BackgroundTransparency = 1
	studsVal.Text = tostring(studs)
	studsVal.Font = Enum.Font.GothamBold
	studsVal.TextSize = 16
	studsVal.TextColor3 = Color3.fromRGB(25, 25, 25)
	studsVal.TextXAlignment = Enum.TextXAlignment.Center
	studsVal.Parent = adjustMenu

	local studsMinus = Instance.new("TextButton")
	studsMinus.Size = UDim2.new(0, 32, 0, 32)
	studsMinus.Position = UDim2.new(0, 170, 0, 44)
	studsMinus.BackgroundColor3 = Color3.fromRGB(200, 80, 80)
	studsMinus.Text = "-"
	studsMinus.Font = Enum.Font.GothamBold
	studsMinus.TextSize = 20
	studsMinus.TextColor3 = Color3.fromRGB(255, 255, 255)
	studsMinus.Parent = adjustMenu

	local studsMinusCorner = Instance.new("UICorner", studsMinus)
	studsMinusCorner.CornerRadius = UDim.new(0, 8)

	local studsPlus = Instance.new("TextButton")
	studsPlus.Size = UDim2.new(0, 32, 0, 32)
	studsPlus.Position = UDim2.new(0, 210, 0, 44)
	studsPlus.BackgroundColor3 = Color3.fromRGB(80, 200, 100)
	studsPlus.Text = "+"
	studsPlus.Font = Enum.Font.GothamBold
	studsPlus.TextSize = 20
	studsPlus.TextColor3 = Color3.fromRGB(255, 255, 255)
	studsPlus.Parent = adjustMenu

	local studsPlusCorner = Instance.new("UICorner", studsPlus)
	studsPlusCorner.CornerRadius = UDim.new(0, 8)

	local speedLabel = Instance.new("TextLabel")
	speedLabel.Size = UDim2.new(0, 70, 0, 28)
	speedLabel.Position = UDim2.new(0, 12, 0, 82)
	speedLabel.BackgroundTransparency = 1
	speedLabel.Text = "Speed"
	speedLabel.Font = Enum.Font.Gotham
	speedLabel.TextSize = 16
	speedLabel.TextColor3 = Color3.fromRGB(25, 25, 25)
	speedLabel.TextXAlignment = Enum.TextXAlignment.Left
	speedLabel.Parent = adjustMenu

	local speedVal = Instance.new("TextLabel")
	speedVal.Size = UDim2.new(0, 50, 0, 28)
	speedVal.Position = UDim2.new(0, 110, 0, 82)
	speedVal.BackgroundTransparency = 1
	speedVal.Text = string.format("%.1f", speedMult)
	speedVal.Font = Enum.Font.GothamBold
	speedVal.TextSize = 16
	speedVal.TextColor3 = Color3.fromRGB(25, 25, 25)
	speedVal.TextXAlignment = Enum.TextXAlignment.Center
	speedVal.Parent = adjustMenu

	local speedMinus = Instance.new("TextButton")
	speedMinus.Size = UDim2.new(0, 32, 0, 32)
	speedMinus.Position = UDim2.new(0, 170, 0, 80)
	speedMinus.BackgroundColor3 = Color3.fromRGB(200, 80, 80)
	speedMinus.Text = "-"
	speedMinus.Font = Enum.Font.GothamBold
	speedMinus.TextSize = 20
	speedMinus.TextColor3 = Color3.fromRGB(255, 255, 255)
	speedMinus.Parent = adjustMenu

	local speedMinusCorner = Instance.new("UICorner", speedMinus)
	speedMinusCorner.CornerRadius = UDim.new(0, 8)

	local speedPlus = Instance.new("TextButton")
	speedPlus.Size = UDim2.new(0, 32, 0, 32)
	speedPlus.Position = UDim2.new(0, 210, 0, 80)
	speedPlus.BackgroundColor3 = Color3.fromRGB(80, 200, 100)
	speedPlus.Text = "+"
	speedPlus.Font = Enum.Font.GothamBold
	speedPlus.TextSize = 20
	speedPlus.TextColor3 = Color3.fromRGB(255, 255, 255)
	speedPlus.Parent = adjustMenu

	local speedPlusCorner = Instance.new("UICorner", speedPlus)
	speedPlusCorner.CornerRadius = UDim.new(0, 8)

	studsMinus.MouseButton1Click:Connect(function()
		studs = math.max(0.5, studs - 1)
		studsVal.Text = tostring(studs)
	end)

	studsPlus.MouseButton1Click:Connect(function()
		studs = math.min(40, studs + 1)
		studsVal.Text = tostring(studs)
	end)

	speedMinus.MouseButton1Click:Connect(function()
		speedMult = math.max(0.1, math.floor(((speedMult - 0.1) * 10 + 0.5)) / 10)
		speedVal.Text = string.format("%.1f", speedMult)
	end)

	speedPlus.MouseButton1Click:Connect(function()
		speedMult = math.min(5, math.floor(((speedMult + 0.1) * 10 + 0.5)) / 10)
		speedVal.Text = string.format("%.1f", speedMult)
	end)

	makeDraggable(adjustMenu)

	local closeBtn = Instance.new("TextButton")
	closeBtn.Size = UDim2.new(0, 22, 0, 22)
	closeBtn.Position = UDim2.new(1, -26, 0, 6)
	closeBtn.Text = "x"
	closeBtn.Font = Enum.Font.GothamBold
	closeBtn.TextSize = 14
	closeBtn.BackgroundColor3 = Color3.fromRGB(200, 80, 80)
	closeBtn.Parent = adjustMenu

	local closeBtnCorner = Instance.new("UICorner", closeBtn)
	closeBtnCorner.CornerRadius = UDim.new(0, 6)

	closeBtn.MouseButton1Click:Connect(function()
		if adjustMenu and adjustMenu.Parent then
			adjustMenu:Destroy()
			adjustMenu = nil
		end
	end)
end

adjustBtn.MouseButton1Click:Connect(function()
	clickSnd:Play()
	if not adjustMenu or not adjustMenu.Parent then
		makeAdjustMenu()
	else
		adjustMenu:Destroy()
		adjustMenu = nil
	end
end)

Players.PlayerAdded:Connect(refreshList)
Players.PlayerRemoving:Connect(refreshList)

RunService.Heartbeat:Connect(function()
	if not espOn then
		return
	end

	local t = nil
	if selectedPlr and selectedPlr.Character and selectedPlr.Character:FindFirstChild("HumanoidRootPart") then
		t = selectedPlr.Character
	elseif targetNearOn then
		t = findTarget(RANGE)
	end

	if t then
		makeESP(t)
	else
		clearESP()
	end
end)

print("[Dashboard] All systems loaded and ready!")
